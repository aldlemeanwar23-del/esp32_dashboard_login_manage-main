<div class="container">
  <div class="device-card" id="card1"></div>
  <div class="device-card" id="card2"></div>
  <div class="device-card" id="card3"></div>
  <div class="device-card" id="card4"></div>
</div>

<script>
function toDeviceId(num){ return "max"+num; }

async function loadCard(num){
  const el=document.getElementById("card"+num);
  const deviceId=toDeviceId(num);
  try{
    const res=await fetch(`/api/sensor?device=${deviceId}`);
    const data=await res.json();
    if(!data.length){ el.innerHTML=`<h3>Sensor ${num}</h3><p>No data</p>`; return; }
    const last=data[data.length-1];
    el.innerHTML=`
      <h3>MAX30102 — ${deviceId.toUpperCase()}</h3>
      <div class="data"><span class="label">Heart Rate</span><span class="value">${last.heartrate} BPM</span></div>
      <div class="data"><span class="label">SpO₂</span><span class="value">${last.spo2} %</span></div>
      <div class="data"><span class="label">Last Update</span><span class="value">${new Date(last.time).toLocaleTimeString()}</span></div>
      <button class="open-btn" onclick="location.href='dashboard.html?sensor=${deviceId}'">Open Live Dashboard</button>
    `;
  } catch(e){ el.innerHTML=`<h3>Sensor ${num}</h3><p>Error loading</p>`; console.error(e);}
}

[1,2,3,4].forEach(loadCard);
setInterval(()=>[1,2,3,4].forEach(loadCard),3000);
</script>
