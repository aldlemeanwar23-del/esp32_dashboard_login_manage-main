<input id="searchInput" placeholder="Search by patient name" />
<button onclick="loadArchive()">Search</button>

<table>
<thead>
<tr>
<th>ID</th>
<th>Device</th>
<th>Patient</th>
<th>Heart Rate</th>
<th>SpO₂</th>
<th>Timestamp</th>
</tr>
</thead>
<tbody id="archiveRows"></tbody>
</table>

<script>
async function loadArchive() {
  const search = document.getElementById('searchInput').value;
  const res = await fetch(`/api/archiveGet?search=${encodeURIComponent(search)}`);
  const data = await res.json();
  const tbody = document.getElementById('archiveRows');
  tbody.innerHTML = '';

  data.forEach(r => {
    tbody.innerHTML += `
<tr>
<td>${r.id}</td>
<td>${r.device_id}</td>
<td>${r.p_name || ''}</td>
<td>${r.heartrate}</td>
<td>${r.spo2}</td>
<td>${new Date(r.timestamp).toLocaleString()}</td>
</tr>`;
  });
}

// تحميل جميع البيانات عند فتح الصفحة
loadArchive();
</script>
