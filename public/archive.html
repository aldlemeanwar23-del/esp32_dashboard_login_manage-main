<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Archived Sensor Data</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --primary: #0ea5e9;
  --secondary: #00ffff;
  --bg: #0c111b;
  --card-bg: rgba(255,255,255,0.05);
  --border: rgba(255,255,255,0.2);
  --hover: rgba(0,255,255,0.1);
  --font: 'Segoe UI', Arial, sans-serif;
}

body {
  margin:0;
  font-family: var(--font);
  background: var(--bg);
  color: #fff;
}

h2 {
  text-align:center;
  color: var(--secondary);
  margin: 20px 0;
  font-size: 28px;
}

.top-bar {
  display:flex;
  justify-content:space-between;
  align-items:center;
  width:95%;
  margin:auto;
  padding:10px 0;
}

.top-bar button {
  padding: 8px 16px;
  border: none;
  border-radius: 8px;
  background: var(--primary);
  color: #fff;
  font-weight: 600;
  cursor: pointer;
  transition: 0.2s;
}
.top-bar button:hover { background: #00bcd4; }

.form {
  width:95%;
  margin:15px auto;
  display:flex;
  gap:10px;
}
.form input {
  flex:1;
  padding:8px;
  border-radius:6px;
  border:1px solid var(--border);
  background:#020617;
  color:#fff;
  text-align:center;
  font-size:14px;
}
.form button {
  padding:8px 12px;
  background: var(--primary);
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-weight:bold;
}
.form button:hover { opacity:0.85; }

table {
  width:95%;
  margin:auto;
  border-collapse:separate;
  border-spacing:0;
  background: var(--card-bg);
  border-radius:12px;
  overflow:hidden;
  box-shadow: 0 5px 15px rgba(0,255,255,0.15);
}

th, td {
  padding:8px 6px;
  text-align:center;
  font-size:14px;
  border-bottom:1px solid var(--border);
}

th { background:#001f2f; position: sticky; top:0; z-index:2; }
tr:hover { background: var(--hover); }

@media (max-width: 768px) {
  table, thead, tbody, th, td, tr { display:block; }
  tr { margin-bottom:15px; }
  th, td { text-align:right; padding-right:15px; position:relative; }
  td::before { position:absolute; left:10px; text-align:left; font-weight:bold; white-space:nowrap; content: attr(data-label); color:#00ffff; }
  th::before { display:none; }
}
</style>
</head>

<body>

<script>
if(localStorage.getItem('auth')!=='1') location.href='/login.html';
</script>

<div class="top-bar">
  <h2>ğŸ“¦ Archived Sensor Data</h2>
  <button onclick="location.href='admin.html'">â† Back</button>
</div>

<div class="form">
  <input id="searchName" placeholder="Search by Patient Name...">
  <button onclick="loadArchive()">Search</button>
</div>

<table>
<thead>
<tr>
<th>ID</th>
<th>Device</th>
<th>Patient</th>
<th>Heart Rate</th>
<th>SpOâ‚‚</th>
<th>Timestamp</th>
</tr>
</thead>
<tbody id="rows"></tbody>
</table>

<script>
async function loadArchive(){
  const search = document.getElementById('searchName').value.trim();
  const res = await fetch('/api/archiveGet'); // ÙŠØ¬Ø¨ Ø£Ù† ØªØ¹ÙŠØ¯ API Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† sensor_data_archive
  const data = await res.json();
  const tbody = document.getElementById('rows');
  tbody.innerHTML = '';

  // ÙÙ„ØªØ±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø±ÙŠØ¶
  const filtered = search ? data.filter(d=> d.p_name.toLowerCase().includes(search.toLowerCase())) : data;

  filtered.forEach(r=>{
    tbody.innerHTML += `
<tr>
<td data-label="ID">${r.id}</td>
<td data-label="Device">${r.device_id}</td>
<td data-label="Patient">${r.p_name}</td>
<td data-label="Heart Rate">${r.heartrate}</td>
<td data-label="SpOâ‚‚">${r.spo2}</td>
<td data-label="Timestamp">${new Date(r.timestamp).toLocaleString()}</td>
</tr>`;
  });
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
loadArchive();
</script>

</body>
</html>
